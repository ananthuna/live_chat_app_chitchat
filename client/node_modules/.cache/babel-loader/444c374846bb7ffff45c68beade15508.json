{"ast":null,"code":"import _toConsumableArray from\"/home/ananthu/Desktop/chat-app/client/chat-app-react-frondend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/ananthu/Desktop/chat-app/client/chat-app-react-frondend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useRef,useState}from'react';import{Box,Stack}from'@mui/system';import AdminNavbar from'../components/AdminHeader';import ChatHeader from'../components/ChatHeader';import SideBar from'../components/SideBar';import ChatBody from'../components/ChatBody';import ChatFooter from'../components/ChatFooter';import{UserContext}from'../Context/Context';import{ChatContext}from'../Context/ChatContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chatpage(_ref){var socket=_ref.socket;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),typingStatus=_useState4[0],setTypingStatus=_useState4[1];var lastMessageRef=useRef(null);var _useContext=useContext(ChatContext),chat=_useContext.chat;var _useContext2=useContext(UserContext),user=_useContext2.user,setUser=_useContext2.setUser;useEffect(function(){var User=JSON.parse(localStorage.getItem('user'));if(User)setUser(User);User&&socket.emit('newUser',User);},[socket]);useEffect(function(){socket.on(user.Name,function(data){setMessages(function(messages){return[].concat(_toConsumableArray(messages),[data]);});console.log(\"recive msg\");console.log(data);});socket.on(\"type\".concat(user.Name),function(_ref2){var type=_ref2.type;setTypingStatus(type);});},[socket]);useEffect(function(){var _lastMessageRef$curre;// üëáÔ∏è scroll to bottom every time messages change\n(_lastMessageRef$curre=lastMessageRef.current)===null||_lastMessageRef$curre===void 0?void 0:_lastMessageRef$curre.scrollIntoView({behavior:'smooth'});},[messages]);return/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(Stack,{direction:\"row\",justifyContent:\"space-between\",children:[chat?/*#__PURE__*/_jsxs(Box,{sx:{width:{xs:'100%',sm:'65%',md:\"75%\"},display:{sm:'none'}},children:[/*#__PURE__*/_jsx(ChatHeader,{setMessages:setMessages}),/*#__PURE__*/_jsx(ChatBody,{messages:messages,lastMessageRef:lastMessageRef,typingStatus:typingStatus}),/*#__PURE__*/_jsx(ChatFooter,{})]}):/*#__PURE__*/_jsxs(Box,{sx:{width:{xs:\"100%\",sm:'35%',md:\"25%\"},display:{sm:'none'}},children:[/*#__PURE__*/_jsx(AdminNavbar,{user:user}),/*#__PURE__*/_jsx(SideBar,{})]}),/*#__PURE__*/_jsxs(Box,{sx:{width:{xs:\"100%\",sm:'35%',md:\"25%\"},display:{xs:'none',sm:'block'}},children:[/*#__PURE__*/_jsx(AdminNavbar,{user:user}),/*#__PURE__*/_jsx(SideBar,{})]}),/*#__PURE__*/_jsxs(Box,{sx:{width:{xs:'100%',sm:'65%',md:\"75%\"},display:{xs:\"none\",sm:\"block\"}},children:[/*#__PURE__*/_jsx(ChatHeader,{setMessages:setMessages}),/*#__PURE__*/_jsx(ChatBody,{messages:messages,lastMessageRef:lastMessageRef,typingStatus:typingStatus}),/*#__PURE__*/_jsx(ChatFooter,{})]})]})});}export default Chatpage;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","Box","Stack","AdminNavbar","ChatHeader","SideBar","ChatBody","ChatFooter","UserContext","ChatContext","Chatpage","socket","messages","setMessages","typingStatus","setTypingStatus","lastMessageRef","chat","user","setUser","User","JSON","parse","localStorage","getItem","emit","on","Name","data","console","log","type","current","scrollIntoView","behavior","width","xs","sm","md","display"],"sources":["/home/ananthu/Desktop/chat-app/client/chat-app-react-frondend/src/pages/Chatpage.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react'\nimport { Box, Stack } from '@mui/system'\nimport AdminNavbar from '../components/AdminHeader'\nimport ChatHeader from '../components/ChatHeader'\nimport SideBar from '../components/SideBar'\nimport ChatBody from '../components/ChatBody'\nimport ChatFooter from '../components/ChatFooter'\nimport { UserContext } from '../Context/Context'\nimport { ChatContext } from '../Context/ChatContext';\n\n\nfunction Chatpage({ socket }) {\n  const [messages, setMessages] = useState([])\n  const [typingStatus, setTypingStatus] = useState('')\n  const lastMessageRef = useRef(null);\n  const { chat } = useContext(ChatContext)\n  const { user, setUser } = useContext(UserContext)\n  useEffect(() => {\n\n    let User = JSON.parse(localStorage.getItem('user'))\n    if (User) setUser(User)\n    User && socket.emit('newUser', User)\n  }, [socket])\n\n  useEffect(() => {\n    socket.on(user.Name, (data) => {\n      setMessages(messages => [...messages, data])\n      console.log(\"recive msg\");\n      console.log(data);\n    })\n    socket.on(`type${user.Name}`, ({ type }) => {\n      setTypingStatus(type)\n    })\n  }, [socket])\n\n\n  useEffect(() => {\n    // üëáÔ∏è scroll to bottom every time messages change\n    lastMessageRef.current?.scrollIntoView({ behavior: 'smooth' });\n\n  }, [messages]);\n\n\n\n  return (\n    <Box >\n      <Stack direction=\"row\" justifyContent=\"space-between\">\n\n        {chat ? (\n          <Box sx={{ width: { xs: '100%', sm: '65%', md: \"75%\" }, display: { sm: 'none' } }} >\n            <ChatHeader setMessages={setMessages} />\n            <ChatBody messages={messages} lastMessageRef={lastMessageRef} typingStatus={typingStatus} />\n            <ChatFooter />\n          </Box>\n        ) : (\n          <Box sx={{ width: { xs: \"100%\", sm: '35%', md: \"25%\" }, display: { sm: 'none' } }}>\n            <AdminNavbar user={user} />\n            <SideBar />\n          </Box>\n        )}\n\n\n        <Box sx={{ width: { xs: \"100%\", sm: '35%', md: \"25%\" }, display: { xs: 'none', sm: 'block' } }}>\n          <AdminNavbar user={user} />\n          <SideBar />\n        </Box>\n\n        <Box sx={{ width: { xs: '100%', sm: '65%', md: \"75%\" }, display: { xs: \"none\", sm: \"block\" } }} >\n          <ChatHeader setMessages={setMessages} />\n          <ChatBody messages={messages} lastMessageRef={lastMessageRef} typingStatus={typingStatus} />\n          <ChatFooter />\n        </Box>\n\n      </Stack>\n    </Box>\n  )\n}\n\nexport default Chatpage\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}