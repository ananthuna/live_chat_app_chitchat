{"ast":null,"code":"import _slicedToArray from\"/home/ananthu/Desktop/chat-app/client/chat-app-react-frondend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Typography,Avatar}from'@mui/material';import React,{useContext,useRef}from'react';import{ChatContext}from'../Context/ChatContext';import{UserContext}from'../Context/Context';import socket from'../socket';import'./background/bg.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatBody(_ref){var messages=_ref.messages;var _useContext=useContext(ChatContext),chat=_useContext.chat;var _useContext2=useContext(UserContext),user=_useContext2.user;var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),typingStatus=_React$useState2[0],setTypingStatus=_React$useState2[1];var lastMessageRef=useRef(null);// const [messagess, setMessagess] = React.useState([])\n// React.useEffect(() => {\n//   messages.forEach((msg) => {\n//     if (msg.from === user.Name && msg.to === chat.Name) {\n//       setMessagess([...msg])\n//     }\n//   })\n// }, [messages, chat, user])\nReact.useEffect(function(){// send typing status to backend using socket.io\n// console.log(`type${user.Name}`);\nsocket.on(\"type\".concat(user.Name),function(data){// console.log(data);\nsetTypingStatus(data.type);});});React.useEffect(function(){var _lastMessageRef$curre;// üëáÔ∏è scroll to bottom every time messages change\n(_lastMessageRef$curre=lastMessageRef.current)===null||_lastMessageRef$curre===void 0?void 0:_lastMessageRef$curre.scrollIntoView({behavior:'smooth'});// console.log('ref')\n});return/*#__PURE__*/_jsxs(Box,{position:\"relative\",zIndex:100,mt:\"4rem\",bgcolor:\"#17191A\",children:[/*#__PURE__*/_jsx(Box,{sx:{bgcolor:'#17191A',width:'100%',height:'42rem',position:'fixed',zIndex:-100,mt:'-4rem'}}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Box,{sx:{overflowY:\"scroll\",overflow:'hidden'},children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{pb:8,pt:3},children:[chat?messages.map(function(message,index){return message.from===user.Name?message.to===chat.Name&&/*#__PURE__*/_jsxs(Box,{display:\"inline-flex\",width:\"100%\",justifyContent:\"right\",sx:{p:2,gap:2},children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"right\",gap:2,children:[/*#__PURE__*/_jsx(Typography,{fontSize:\"0.9rem\",align:\"right\",color:\"white\",children:/*#__PURE__*/_jsx(\"b\",{children:\"You\"})}),/*#__PURE__*/_jsx(Typography,{fontSize:\"0.9rem\",align:\"right\",color:\"#808080\",children:message.time})]}),/*#__PURE__*/_jsx(Box,{sx:{bgcolor:\"#272930\",Width:\"50%\",p:2,borderRadius:'1rem 0 1rem 1rem',fontSize:\"2rem\"},children:/*#__PURE__*/_jsx(Typography,{sx:{color:'white',fontSize:'0.9rem',lineHeight:'20px'},children:message.message})})]}),/*#__PURE__*/_jsx(Avatar,{sx:{height:35,width:35},alt:\"img\",src:user.imageURL})]},index):message.from===chat.Name&&/*#__PURE__*/_jsxs(Box,{display:\"inline-flex\",width:\"100%\",justifyContent:\"left\",sx:{p:2,gap:2},children:[/*#__PURE__*/_jsx(Avatar,{sx:{height:35,width:35},alt:\"img\",src:chat.imageURL}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"left\",gap:2,children:[/*#__PURE__*/_jsx(Typography,{fontSize:\"0.9rem\",align:\"right\",color:\"white\",children:/*#__PURE__*/_jsx(\"b\",{children:message.from})}),/*#__PURE__*/_jsx(Typography,{fontSize:\"0.9rem\",align:\"right\",color:\"#808080\",children:message.time})]}),/*#__PURE__*/_jsx(Box,{sx:{bgcolor:\"#272930\",Width:\"50%\",p:2,borderRadius:'0rem 1rem 1rem 1rem'},children:/*#__PURE__*/_jsx(Typography,{sx:{color:'white',fontSize:'0.9rem',lineHeight:'8px'},children:message.message})})]})]},index);}):/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",justifyContent:\"center\",pt:20},children:/*#__PURE__*/_jsx(Typography,{sx:{color:'white'},children:\"Chat is empty \"})}),/*#__PURE__*/_jsx(Box,{ref:lastMessageRef})]}),/*#__PURE__*/_jsxs(Box,{sx:{position:\"fixed\",bottom:\"13%\",display:'flex',flexDirection:'row',justifyContent:'center',alignItems:'center',gap:1,ml:2},children:[chat&&typingStatus&&/*#__PURE__*/_jsx(Avatar,{sx:{height:35,width:35},alt:\"img\",src:chat.imageURL}),/*#__PURE__*/_jsx(Typography,{sx:{color:'white'},children:typingStatus&&chat&&\"\".concat(typingStatus,\" is typing...\")})]})]})})})]});}export default ChatBody;","map":{"version":3,"names":["Box","Typography","Avatar","React","useContext","useRef","ChatContext","UserContext","socket","ChatBody","messages","chat","user","useState","typingStatus","setTypingStatus","lastMessageRef","useEffect","on","Name","data","type","current","scrollIntoView","behavior","bgcolor","width","height","position","zIndex","mt","overflowY","overflow","pb","pt","map","message","index","from","to","p","gap","time","Width","borderRadius","fontSize","color","lineHeight","imageURL","display","justifyContent","bottom","flexDirection","alignItems","ml"],"sources":["/home/ananthu/Desktop/chat-app/client/chat-app-react-frondend/src/components/ChatBody.jsx"],"sourcesContent":["import { Box, Typography, Avatar } from '@mui/material'\nimport React, { useContext, useRef } from 'react'\nimport { ChatContext } from '../Context/ChatContext';\nimport { UserContext } from '../Context/Context';\nimport socket from '../socket';\nimport './background/bg.css'\n\nfunction ChatBody({ messages }) {\n  const { chat } = useContext(ChatContext)\n  const { user } = useContext(UserContext)\n  const [typingStatus, setTypingStatus] = React.useState('')\n  const lastMessageRef = useRef(null);\n  // const [messagess, setMessagess] = React.useState([])\n\n  // React.useEffect(() => {\n  //   messages.forEach((msg) => {\n  //     if (msg.from === user.Name && msg.to === chat.Name) {\n  //       setMessagess([...msg])\n  //     }\n  //   })\n  // }, [messages, chat, user])\n\n\n\n  React.useEffect(() => {\n    // send typing status to backend using socket.io\n    // console.log(`type${user.Name}`);\n    socket.on(`type${user.Name}`, (data) => {\n      // console.log(data);\n      setTypingStatus(data.type)\n    });\n  });\n\n  React.useEffect(() => {\n    // üëáÔ∏è scroll to bottom every time messages change\n    lastMessageRef.current?.scrollIntoView({ behavior: 'smooth' });\n    // console.log('ref')\n  });\n\n\n\n  return (\n\n    <Box position='relative' zIndex={100} mt='4rem' bgcolor='#17191A'>\n      <Box sx={{ \n        bgcolor: '#17191A', \n        width: '100%', \n        height: '42rem', \n        position: 'fixed', \n        zIndex: -100,\n        mt:'-4rem'\n        }}>\n\n      </Box>\n      <Box>\n        <Box sx={{ overflowY: \"scroll\", overflow: 'hidden' }}>\n          <Box>\n            <Box sx={{ pb: 8, pt: 3 }}>\n              {/* ////// */}\n              {chat ? (messages.map((message, index) =>\n                message.from === user.Name ? (\n                  message.to === chat.Name && <Box\n                    key={index}\n                    display=\"inline-flex\"\n                    width='100%'\n                    justifyContent=\"right\"\n                    sx={{ p: 2, gap: 2 }}>\n                    <Box>\n                      <Box display='flex' justifyContent='right' gap={2}>\n                        <Typography fontSize='0.9rem' align='right' color='white'><b>You</b></Typography>\n                        <Typography fontSize='0.9rem' align='right' color='#808080'>{message.time}</Typography>\n                      </Box>\n                      <Box sx={{ bgcolor: \"#272930\", Width: \"50%\", p: 2, borderRadius: '1rem 0 1rem 1rem', fontSize: \"2rem\" }}>\n                        <Typography sx={{ color: 'white', fontSize: '0.9rem', lineHeight: '20px' }}>{message.message}</Typography>\n                      </Box>\n                    </Box>\n                    <Avatar sx={{\n                      height: 35,\n                      width: 35\n                    }} alt=\"img\" src={user.imageURL} />\n                  </Box>\n                ) : (\n                  message.from === chat.Name && <Box\n                    key={index}\n                    display=\"inline-flex\"\n                    width='100%'\n                    justifyContent=\"left\"\n                    sx={{ p: 2, gap: 2 }}>\n                    <Avatar sx={{\n                      height: 35,\n                      width: 35\n                    }} alt=\"img\" src={chat.imageURL} />\n                    <Box>\n                      <Box display='flex' justifyContent='left' gap={2}>\n                        <Typography fontSize='0.9rem' align='right' color='white'><b>{message.from}</b></Typography>\n                        <Typography fontSize='0.9rem' align='right' color='#808080'>{message.time}</Typography>\n                      </Box>\n                      {/* <Typography align='left'>{message.from}</Typography> */}\n                      <Box sx={{ bgcolor: \"#272930\", Width: \"50%\", p: 2, borderRadius: '0rem 1rem 1rem 1rem' }}>\n                        <Typography sx={{ color: 'white', fontSize: '0.9rem', lineHeight: '8px' }}>{message.message}</Typography>\n                      </Box>\n                    </Box>\n                  </Box>\n                )\n              )) : (\n                <Box sx={{\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  pt: 20\n                }}>\n                  <Typography sx={{ color: 'white' }}>Chat is empty </Typography>\n                </Box>\n              )}\n              <Box ref={lastMessageRef} />\n            </Box>\n            <Box sx={{\n              position: \"fixed\",\n              bottom: \"13%\",\n              display: 'flex',\n              flexDirection: 'row',\n              justifyContent: 'center',\n              alignItems: 'center',\n              gap: 1,\n              ml: 2\n            }}>\n              {chat && typingStatus && <Avatar sx={{\n                height: 35,\n                width: 35\n              }} alt=\"img\" src={chat.imageURL} />}\n              <Typography sx={{ color: 'white' }}>{typingStatus && chat && `${typingStatus} is typing...`}</Typography>\n            </Box>\n          </Box>\n        </Box>\n      </Box>\n    </Box>\n  )\n}\n\nexport default ChatBody\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}